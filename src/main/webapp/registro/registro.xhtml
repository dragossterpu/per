<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
<f:view>
	<ui:composition template="../layouts/layoutInterior.xhtml">
		<ui:define name="content">

		<h3>Búsqueda de registro de actividad</h3>
		
		<h:form>
		    <p:remoteCommand name="onload" action="#{regActividadBean.getFormularioRegActividad}" autoRun="true" />
		</h:form>

		<h:form id="busquedalistaRegActividad" >
		
			<div class="bloqueFormulario">
					<div class="columnaIzdaFormulario">
						<h:outputLabel for="nombreSeccion" value="Nombre de la sección:" />
						<p:inputText id="nombreSeccion" value="#{regActividadBean.regActividadBusqueda.nombreSeccion}" />
						
						<h:outputLabel for="usernameRegActividad" value="Usuario del registro:" />
						<p:inputText id="usernameRegActividad" value="#{regActividadBean.regActividadBusqueda.usernameRegActividad}"/>
											        
					</div>
	
					<div class="columnaDchaFormulario">
						<h:outputLabel for="fechaDesde" value="Fecha desde:" />
						<p:calendar value="#{regActividadBean.regActividadBusqueda.fechaDesde}" id="fechaDesde" pattern="dd/MM/yyyy" navigator="true"/>
						<h:outputLabel for="fechaHasta" value="Fecha hasta:" />
						<p:calendar value="#{regActividadBean.regActividadBusqueda.fechaHasta}" id="fechaHasta" pattern="dd/MM/yyyy" navigator="true"/>
												
						<h:outputLabel for="tipoRegActividad" value="Tipo de notificación:" />
						<p:inputText id="tipoRegActividad" value="#{regActividadBean.regActividadBusqueda.tipoRegActividad}"/>
						
					</div>
					
			</div>
			
			<div class="botonesFormulario">
			<p:commandButton actionListener="#{regActividadBean.buscarRegActividad}" value="Buscar" update="panelRegActividad" icon="fa fa-search" />
			<p:commandButton actionListener="#{regActividadBean.getFormularioRegActividad()}" value="Limpiar" update="busquedalistaRegActividad" icon="fa fa-search" />

			</div>
			<p:outputPanel layout="block" id="panelRegActividad" >
 				<p:outputPanel rendered="#{not empty regActividadBean.regActividadBusqueda.listaRegActividad}">
	 				<h:commandLink>
		               <p:graphicImage  value="/images/xls.png" />
		               <p:dataExporter type="xls" target="tablaRegActividad" fileName="listaRegActividad"/>
		            </h:commandLink>
		            <h:commandLink>
		               <p:graphicImage  value="/images/pdf.png" />
		               <p:dataExporter type="pdf" target="tablaRegActividad" fileName="listaRegActividad"/>
		            </h:commandLink>
		            <h:commandLink>
		               <p:graphicImage  value="/images/csv.png" />
		               <p:dataExporter type="csv" target="tablaRegActividad" fileName="listaRegActividad"/>
		            </h:commandLink>
		            <h:commandLink>
		            	<p:graphicImage  value="/images/imprimir.jpg" />
		            	<p:printer target="busquedalistaRegActividad" />
		            </h:commandLink>
	            </p:outputPanel>

	 			<p:dataTable  var="regActividad" value="#{regActividadBean.regActividadBusqueda.listaRegActividad}"  rows="20" id="tablaRegActividad"
	                         draggableColumns="true"
	                         paginator="true" 
	                         resizableColumns="true"
	                         rendered="#{not empty regActividadBean.regActividadBusqueda.listaRegActividad}"
	                         style="">
					 <f:facet name="header">
						Registros de actividad
						 <p:commandButton id="toggler" type="button" value="Columns" style="float:right" icon="fa fa-th"/>
	        			 <p:columnToggler datasource="tablaRegActividad" trigger="toggler">
	        			 	  <p:ajax event="toggle" listener="#{regActividadBean.onToggle}" />
	        			 </p:columnToggler>
					</f:facet>
					<p:column headerText="Fecha " sortBy="#{regActividad.fechaAlta}" width="70" visible="#{regActividadBean.list[0]}" exportable="#{regActividadBean.list[0]}">
						<h:outputText value="#{regActividad.fechaAlta}">
							<f:convertDateTime pattern="dd/MM/yyyy" timeZone="Europe/Madrid"/>
						</h:outputText>
					</p:column>
					<p:column headerText="Nombre Sección" sortBy="#{regActividad.nombreSeccion}" width="70" visible="#{regActividadBean.list[1]}" exportable="#{regActividadBean.list[1]}">
						<h:outputText value="#{regActividad.nombreSeccion}" />
					</p:column>
					<p:column headerText="Usuario del registro" sortBy="#{regActividad.usernameRegActividad}"  width="70" visible="#{regActividadBean.list[2]}" exportable="#{regActividadBean.list[2]}">
						<h:outputText value="#{regActividad.usernameRegActividad}" />
					</p:column>
					<p:column headerText="Descripción" sortBy="#{regActividad.descripcion}" width="100" visible="#{regActividadBean.list[3]}" exportable="#{regActividadBean.list[3]}">
						<h:outputText value="#{regActividad.descripcion}" />
					</p:column>					
					<p:column headerText="Tipo notificación" sortBy="#{regActividad.tipoRegActividad}" width="100" visible="#{regActividadBean.list[4]}" exportable="#{regActividadBean.list[4]}">
						<h:outputText value="#{regActividad.tipoRegActividad}" />
					</p:column>
						<p:column style="width:30px">
							<p:commandButton title="Eliminar" icon="fa fa-trash"
								actionListener="#{regActividadBean.eliminarRegActividad(regActividad)}"
								update="tablaRegActividad">
								<p:confirm header="Eliminar registro de actividad"
									message="¿Está seguro que desea eliminar este registro de actividad?"
									icon="fa fa-warning-sign" />
							</p:commandButton>
						</p:column>
					<f:facet name="footer">
	       				 Resultado de la búsqueda: #{fn:length(regActividadBean.regActividadBusqueda.listaRegActividad)} registros.
	    			</f:facet>
				</p:dataTable>
			</p:outputPanel>
</h:form>
		<p:confirmDialog global="true">
			<div class="centrarBotonesDialog">
				<p:commandButton value="Sí" type="button" styleClass="ui-confirmdialog-yes" icon="fa fa-check" />
				<p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="fa fa-icon-remove" />
			</div>
		</p:confirmDialog>

		</ui:define>
		
	</ui:composition>
</f:view>

</html>
