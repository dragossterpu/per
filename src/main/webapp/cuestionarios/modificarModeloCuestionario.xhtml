<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:my="http://java.sun.com/jsf/composite/composites"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
<f:view>
	<ui:composition template="../layouts/layoutInterior.xhtml">
		<ui:define name="content">
		
		
		
		<h:form id="form">
			<div class="tituloCuestionario">
				<h:outputText value="#{modificarModeloCuestionarioBean.modeloCuestionario.descripcion}"/> 
			</div>
			
			<p:wizard flowListener="#{modificarModeloCuestionarioBean.onFlowProcess}"
					nextLabel="Siguiente" backLabel='Atr&aacute;s'>
				<p:tab id="nombre" title="Nombre">
					<p:panel header="Nombre">
						<h:panelGrid columns="2" columnClasses="label, value">
							<h:outputLabel for="nombreModelo" value="Nombre del modelo:" />
								<p:inputText id="nombreModelo"
									value="#{modificarModeloCuestionarioBean.modeloCuestionario.descripcion}"
									converter="#{trimConverter}"
									required="true"
									maxlength="255"/>
							<h:outputLabel for="codigoModelo" value="Código del modelo:" />
								<p:inputText id="codigoModelo"
									value="#{modificarModeloCuestionarioBean.modeloCuestionario.codigo}"
									converter="#{trimConverter}"
									required="true"
									maxlength="255"/>		
						</h:panelGrid>
						
					</p:panel>
				</p:tab>	
				<p:tab id="areas" title="Áreas">
					<p:orderList id="orderListAreas"  value="#{modificarModeloCuestionarioBean.listaAreasCuestionario}" var="area" itemValue="#{area}" converter="#{areasConverter}" controlsLocation="left" responsive="true">		 
				        <p:ajax event="select" listener="#{modificarModeloCuestionarioBean.onSelectArea}" update="nombreArea"/>
				        <f:facet name="caption">Areas</f:facet> 
				         <p:column>
				            <h:outputText value="#{area.area}" />
				        </p:column>
				    </p:orderList>
				    <p:panel>    
				    	<p:inputText  id="nombreArea" binding="#{modificarModeloCuestionarioBean.nombreArea}"  converter="#{trimConverter}" maxlength="255"/>
					    <p:commandButton actionListener="#{modificarModeloCuestionarioBean.aniadeArea}" update="orderListAreas" 
					    	value="Añadir area" icon="fa fa-fw fa-plus">
					    </p:commandButton>
					    <p:commandButton actionListener="#{modificarModeloCuestionarioBean.borraArea}" update="orderListAreas" 
					    	value="Eliminar area" icon="fa fa-fw fa-minus"/>
				    </p:panel>
				</p:tab>
				<p:tab id="tipoRespuestas" title="Tipos de respuesta">
					<h:panelGrid columns="2">
						<p:panel header="Tipo de respuestas">
							<p:pickList id="pickList" value="#{modificarModeloCuestionarioBean.listaTipoPreguntasPick}" 
							 	var="preguntas" 
							 	itemLabel="#{preguntas}" 
							 	itemValue="#{preguntas}" >	
							</p:pickList>
					    </p:panel>
					</h:panelGrid>	
					<p:panel  header="Nuevos tipos de respuesta">
									<h:outputLabel for="tipoPregunta" value="Tipo a personalizar" />
									<p:selectOneMenu value="#{modificarModeloCuestionarioBean.tipoPersonalizado}" id="tipoPregunta" converter="#{selectConverter}" >
										<f:selectItem itemLabel="Seleccione uno" itemValue="" />
										<f:selectItems value="#{modificarModeloCuestionarioBean.listaTiposPersonalizables}" var="respuestas"
											itemLabel="#{respuestas}" itemValue="#{respuestas}" />
											<p:ajax update="personalizar"  />
									</p:selectOneMenu>
									<p:panel id="personalizar">
										<p:panel rendered="#{modificarModeloCuestionarioBean.tipoPersonalizado eq 'RADIO'}">
											<p:orderList id="orderListValoresRadio" value="#{modificarModeloCuestionarioBean.listadoValoresNuevaRespuesta}" var="valor" 
											itemValue="#{valor}" converter="#{selectConverter}" controlsLocation="left" responsive="true">	
											<p:ajax event="select" listener="#{modificarModeloCuestionarioBean.onSelectValorRadio}" update="nuevoTipoRespuestaRadio"/>	 
												<f:facet name="caption">Valores</f:facet> 
												 <p:column>
													<h:outputText value="#{valor}" />
												</p:column>
												</p:orderList>
												
												<p:inputText id="nuevoTipoRespuestaRadio" binding="#{modificarModeloCuestionarioBean.nuevoValorRadio}" converter="#{trimConverter}" />
												<p:commandButton actionListener="#{modificarModeloCuestionarioBean.aniadeValorRadio}" update="orderListValoresRadio" value="Añadir valor" icon="fa fa-fw fa-plus"/>
												<p:commandButton actionListener="#{modificarModeloCuestionarioBean.borraValorRadio}" update="orderListValoresRadio" value="Eliminar valor" icon="fa fa-fw fa-minus"/>
												
												<p:commandButton value="Añadir tipo de respuesta" type="button" onclick="PF('dialog').show();" />
										</p:panel>
										<p:panel rendered="#{modificarModeloCuestionarioBean.tipoPersonalizado eq 'TABLA'}">
											<p:orderList id="orderListColumnasTabla" value="#{modificarModeloCuestionarioBean.listadoValoresNuevaRespuesta}" var="valor" 
												itemValue="#{valor}" converter="#{selectConverter}" controlsLocation="left" responsive="true">	
												<p:ajax event="select" listener="#{modificarModeloCuestionarioBean.onSelectValorTabla}" update="nuevoTipoRespuestaTabla"/>	 
													<f:facet name="caption">Columnas</f:facet> 
													 <p:column>
														<h:outputText value="#{valor}" />
													</p:column>
													</p:orderList>
													
													<p:inputText id="nuevoTipoRespuestaTabla" binding="#{modificarModeloCuestionarioBean.nuevoValorTabla}" converter="#{trimConverter}" />
													<p:commandButton actionListener="#{modificarModeloCuestionarioBean.aniadeValorTabla}" update="orderListColumnasTabla" value="Añadir columna" icon="fa fa-fw fa-plus"/>
													<p:commandButton actionListener="#{modificarModeloCuestionarioBean.borraValorTabla}" update="orderListColumnasTabla" value="Eliminar columna" icon="fa fa-fw fa-minus"/>
													<p:commandButton value="Añadir tipo de respuesta" type="button" onclick="PF('dialog').show();" />
										</p:panel>
										<p:panel rendered="#{modificarModeloCuestionarioBean.tipoPersonalizado eq 'MATRIZ'}">
											<p:orderList id="orderListColumnasMatriz" value="#{modificarModeloCuestionarioBean.listadoValoresNuevaRespuesta}" var="valor" 
											itemValue="#{valor}" converter="#{selectConverter}" controlsLocation="left" responsive="true">	
											<p:ajax event="select" listener="#{modificarModeloCuestionarioBean.onSelectValor}" update="nuevoTipoRespuestaColumna"/>	 
											<f:facet name="caption">Columnas</f:facet> 
											 <p:column>
												<h:outputText value="#{valor}" />
											</p:column>
											</p:orderList>
											
											<p:inputText id="nuevoTipoRespuestaColumna" binding="#{modificarModeloCuestionarioBean.nuevoValor}" converter="#{trimConverter}" />
											<p:commandButton actionListener="#{modificarModeloCuestionarioBean.aniadeValor}" update="orderListColumnasMatriz" value="Añadir columna" icon="fa fa-fw fa-plus"/>
											<p:commandButton actionListener="#{modificarModeloCuestionarioBean.borraValor}" update="orderListColumnasMatriz" value="Eliminar columna" icon="fa fa-fw fa-minus"/>
											<p:separator />
											<p:orderList id="orderListFilasMatriz" value="#{modificarModeloCuestionarioBean.listadoValoresFila}" var="valor" 
											itemValue="#{valor}" converter="#{selectConverter}" controlsLocation="left" responsive="true">	
											<p:ajax event="select" listener="#{modificarModeloCuestionarioBean.onSelectValorFila}" update="nuevoTipoRespuestaFila"/>	 
											<f:facet name="caption">Filas</f:facet> 
											 <p:column>
												<h:outputText value="#{valor}" />
											</p:column>
											</p:orderList>
											
											<p:inputText id="nuevoTipoRespuestaFila" binding="#{modificarModeloCuestionarioBean.nuevoValorFila}" converter="#{trimConverter}" />
											<p:commandButton actionListener="#{modificarModeloCuestionarioBean.aniadeValorFila}" update="orderListFilasMatriz" value="Añadir fila" icon="fa fa-fw fa-plus"/>
											<p:commandButton actionListener="#{modificarModeloCuestionarioBean.borraValorFila}" update="orderListFilasMatriz" value="Eliminar fila" icon="fa fa-fw fa-minus"/>
											<p:separator />
											<p:commandButton value="Añadir tipo de respuesta" type="button" onclick="PF('dialog').show();" />
										</p:panel>
										
									<p:dialog header="Introduce nombre" widgetVar="dialog" modal="true">
										<p:panel>
											<h:outputLabel for="nombreTipoPregunta" value="Nombre" />
											<p:inputText id="nombreTipoPregunta" binding="#{modificarModeloCuestionarioBean.nombreTipoPregunta}"></p:inputText>
										    <p:commandButton actionListener="#{modificarModeloCuestionarioBean.guardaTipoRespuesta}" value="Añadir tipo de respuesta" update="pickList"
										    	oncomplete="PF('dialog').hide();"/>
										</p:panel>    	
									</p:dialog>	
									</p:panel>
									
										 
								</p:panel>			
													
				</p:tab>		
				<p:tab id="preguntas" title="Preguntas">
					<p:repeat value="#{modificarModeloCuestionarioBean.modeloCuestionario.areas}" var="area">
						<p:accordionPanel activeIndex="-1">
							<p:tab title="#{area.area}">
								<p:orderList id="orderListPreguntas" value="#{area.preguntas}" var="pregunta" itemValue="#{pregunta}" converter="#{preguntasConverter}" controlsLocation="left" responsive="true">		 
							        <p:ajax event="select" listener="#{modificarModeloCuestionarioBean.onSelectPregunta}" update="editarPregunta"/>
							        <f:facet name="caption">Preguntas</f:facet> 
							         <p:column>
							            <h:outputText value="#{pregunta.pregunta}" />
							        </p:column>
							    </p:orderList>
								<h:panelGrid id="editarPregunta" columns="2" columnClasses="label, value"> 
									<h:outputLabel for="textoPregunta" value="Pregunta" />   
									<p:inputText  id="textoPregunta" binding="#{modificarModeloCuestionarioBean.textoPregunta}"  converter="#{trimConverter}" maxlength="255"/>
								    <h:outputLabel for="nuevoTipoPregunta" value="Tipo de pregunta" />
									<p:selectOneMenu binding="#{modificarModeloCuestionarioBean.nuevoTipoPregunta}" id="nuevoTipoPregunta"
										converter="#{selectConverter}" >
										<f:selectItem itemLabel="Seleccione uno" itemValue="" />
										<f:selectItems value="#{modificarModeloCuestionarioBean.listaTipoPreguntasPick.target}" var="tipo"
											itemLabel="#{tipo}" itemValue="#{tipo}" />
									</p:selectOneMenu>
								    <p:commandButton actionListener="#{modificarModeloCuestionarioBean.aniadePregunta(area)}" update="orderListPreguntas" 
								    	value="Añadir pregunta" icon="fa fa-fw fa-plus">
								    </p:commandButton>
								    <p:commandButton actionListener="#{modificarModeloCuestionarioBean.borraPregunta(area)}" update="orderListPreguntas" 
								    	value="Eliminar pregunta" icon="fa fa-fw fa-minus"/>
							    </h:panelGrid>
					    	</p:tab>
					    </p:accordionPanel>			
					</p:repeat>
				</p:tab>
				<p:tab id="finalizar" title="Finalizar">
					<p:panel header="Finalizar">
						 <p:commandButton id="guardar" value="Guardar modelo"  action="#{modificarModeloCuestionarioBean.guardaCuestionario}"
						 oncomplete="PF('dialogCierre').show();" />	
					</p:panel>
				</p:tab>
				
			</p:wizard>
			
			
			<p:dialog  widgetVar="dialogCierre" modal="true">
				<h:outputText class="centrarBotonesDialog" value="la operación se ha realizado con éxito"></h:outputText>
				<div class="centrarBotonesDialog">
				    <p:commandButton outcome="/cuestionarios/modelosCuestionarios" value="Aceptar" oncomplete="PF('dialogCierre').hide();"/>
			    </div>
			</p:dialog>			
			
			
			
			
			
					    
		</h:form>
		</ui:define>
	</ui:composition>
	
</f:view>
</html>
