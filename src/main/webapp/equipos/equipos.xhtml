<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:pe="http://primefaces.org/ui/extensions" >
<f:view>


	<ui:composition template="../layouts/layoutInterior.xhtml">
		<ui:define name="content">

		<h3 style="white-space:pre-line;" >Búsqueda de equipos</h3>
		
		<h:form id="busquedaEquipos" >
		
			<div class="bloqueFormulario">
					<div class="columnaIzdaFormulario">
						<h:outputLabel for="nombreJefe" value="Nombre de jefe de equipo:" />
						<p:inputText id="nombreJefe" value="#{equiposBean.equipoBusqueda.nombreJefe}" />
						
						<h:outputLabel for="nombreMiembro" value="Nombre de miembro de equipo:" />
						<p:inputText id="nombreMiembro" value="#{equiposBean.equipoBusqueda.nombreMiembro}" />
						
						<h:outputLabel for="nombreEquipo" value="Nombre del equipo:" />
						<p:inputText id="nombreEquipo" value="#{equiposBean.equipoBusqueda.nombreEquipo}" />
		
					</div>
	
					<div class="columnaDchaFormulario">
						<h:outputLabel for="fechaDesde" value="Fecha alta desde:" />
						<p:calendar value="#{equiposBean.equipoBusqueda.fechaDesde}" id="fechaDesde" pattern="dd/MM/yyyy" navigator="true"/>
	
						<h:outputLabel for="fechaHasta" value="Fecha alta hasta:" />
						<p:calendar value="#{equiposBean.equipoBusqueda.fechaHasta}" id="fechaHasta" pattern="dd/MM/yyyy" navigator="true"/>
						<h:outputLabel for="estado" value="Estado:" />
				        <p:importEnum type="es.mira.progesin.persistence.entities.enums.EstadoEnum" var="estados"
							allSuffix="ALL_ENUM_VALUES" />
						<p:selectOneMenu value="#{equiposBean.equipoBusqueda.estado}" id="estado"  effect="fold">
							<f:selectItem itemLabel="Seleccione uno" itemValue=""/>
							<f:selectItems value="#{estados.ALL_ENUM_VALUES}" var="estadoEquipo"
								itemLabel="#{estadoEquipo}" itemValue="#{estadoEquipo}" />
						</p:selectOneMenu> 				       
					</div>
			</div>
				<div class="botonesFormularioEquipos">
						<p:commandButton actionListener="#{equiposBean.buscarEquipo}" value="Buscar" update="panelEquipos" icon="ui-icon-search" />
						 <p:commandButton action="#{equiposBean.getFormularioBusquedaEquipos}" value="Limpiar" update="busquedaEquipos" icon="fa fa-fw fa-eraser" />
                		</div>
						<p:separator title="Alta nuevo equipo" styleClass="separator ui-state-disabled"/>
						<div class="botonesFormulario">
						 <h:outputText value="¿Equipo especial?: " />&nbsp;
        				<p:selectBooleanCheckbox value="#{equiposBean.equipoEspecial}" />&nbsp; &nbsp; &nbsp; 
					        <p:commandButton action="#{equiposBean.nuevoEquipo}" value="Nuevo equipo" icon="fa fa-fw fa-user-plus"/> 
						</div>
					<p:outputPanel layout="block" id="panelEquipos" >
		 				<p:outputPanel rendered="#{not empty equiposBean.equipoBusqueda.listaEquipos}">
			 				<h:commandLink>
				               <p:graphicImage  value="/images/xls.png" />
				               <p:dataExporter type="xls" target="tablaEquipos" fileName="listaEquipos" pageOnly="true"/>
				            </h:commandLink>
				            <h:commandLink>
				               <p:graphicImage  value="/images/pdf.png" />
				               <p:dataExporter type="pdf" target="tablaEquipos" fileName="listaEquipos" pageOnly="true"/>
				            </h:commandLink>
				            <h:commandLink>
				               <p:graphicImage  value="/images/csv.png" />
				               <p:dataExporter type="csv" target="tablaEquipos" fileName="listaEquipos" pageOnly="true"/>
				            </h:commandLink>
				            <h:commandLink>
				            	<p:graphicImage  value="/images/imprimir.jpg" />
				            	<p:printer target="busquedaEquipos" />
				            </h:commandLink>
			            </p:outputPanel>
			  		<p:dataTable  var="equipo" value="#{equiposBean.equipoBusqueda.listaEquipos}"  rows="10" id="tablaEquipos"
	                         draggableColumns="true"
	                         paginator="true"
	                         rowsPerPageTemplate="5,10,15" 
	                         resizableColumns="true"
	                         rendered="#{not empty equiposBean.equipoBusqueda.listaEquipos}"
	                         style="">
						<f:facet name="header">
							Equipos
	
						</f:facet>
					<p:column headerText="Fecha alta" sortBy="#{equipo.fechaAlta}" width="70" visible="#{equiposBean.list[0]}" exportable="#{equiposBean.list[0]}">
						<h:outputText value="#{equipo.fechaAlta}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</p:column>
					
					<p:column headerText="Nombre equipo" sortBy="#{equipo.nombreEquipo}" width="70" visible="#{equiposBean.list[1]}" exportable="#{equiposBean.list[1]}">
						<h:outputText value="#{equipo.nombreEquipo}" />
					</p:column>
					<p:column headerText="Usuario jefe de equipo" sortBy="#{equipo.jefeEquipo}"  width="90" visible="#{equiposBean.list[2]}" exportable="#{equiposBean.list[2]}">
						<h:outputText value="#{equipo.jefeEquipo}" />
					</p:column>
					<p:column headerText="Nombre jefe de equipo" sortBy="#{equipo.nombreJefe}"  width="90" visible="#{equiposBean.list[3]}" exportable="#{equiposBean.list[2]}">
						<h:outputText value="#{equipo.nombreJefe}" />
					</p:column>
					
					<p:column headerText="Equipo especial" sortBy="#{equipo.equipoEspecial}"  width="70" visible="#{equiposBean.list[4]}" exportable="#{equiposBean.list[3]}">
						<h:outputText value="#{equipo.equipoEspecial}" />
					</p:column>	
		
					<p:column width="20" exportable="false"  rendered="#{equiposBean.equipo.fechaBaja eq null}">
						<p:commandButton title="Eliminar" icon="ui-icon-trash" actionListener="#{equiposBean.eliminarEquipo(equipo)}"
						update=":busquedaEquipos:panelEquipos tablaEquipos "  >
							<p:confirm header="Eliminar equipo" message="¿Está seguro que desea eliminar este equipo?" icon="ui-icon-alert"/>
						</p:commandButton>
					</p:column>
					<p:column width="20" exportable="false"> 
						<p:commandButton title="Modificar Equipo" icon="fa fa-fw fa-edit" action="#{equiposBean.getFormModificarEquipo(equipo)}" />
					</p:column> 
				<f:facet name="footer">
       				 Resultado de la búsqueda: #{fn:length(equiposBean.equipoBusqueda.listaEquipos)} equipos.
    			</f:facet>

				</p:dataTable>
			</p:outputPanel>			
 		</h:form>
		<p:confirmDialog global="true">
			<div class="centrarBotonesDialog">
				<p:commandButton value="Sí" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
				<p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
			</div>
		</p:confirmDialog>
		
		</ui:define>
		
	</ui:composition>

</f:view>
</html>
