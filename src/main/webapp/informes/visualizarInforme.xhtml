<ui:composition template="../layouts/layoutInterior.xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:p="http://primefaces.org/ui">
    <ui:define name="content">

        <h:form id="informe">
            <ui:param name="yaFinalizado" value="#{not empty informeBean.informe.fechaFinalizacion}" />
                    
            <ui:param name="titulo" value="Informe" />
            <f:event listener="#{navegacionBean.adelante(titulo, request.servletPath)}" type="preRenderView"/>
            
            <link rel="stylesheet" href="#{request.contextPath}/css/texteditor_pdf.css" />
            <p:outputPanel style="float: right;">
                <table>
                <tr>
                    <th>Informe completo</th>
                    <td><h:commandLink actionListener="#{informeBean.exportarInforme('DOCX', 'completo')}" title="Informe completo">
                        <p:graphicImage value="/images/doc.png" style="padding: 0" />
                        <p:fileDownload value="#{informeBean.file}" />
                    </h:commandLink>
                    <h:commandLink actionListener="#{informeBean.exportarInforme('PDF', 'completo')}" title="Informe completo">
                        <p:graphicImage value="/images/pdf.png" style="padding: 0" />
                        <p:fileDownload value="#{informeBean.file}" />
                    </h:commandLink></td>
                </tr>
                <tr>
                    <th>Conclusiones</th>
                    <td><h:commandLink actionListener="#{informeBean.exportarInforme('DOCX', 'conclusiones')}" title="Conclusiones">
                        <p:graphicImage value="/images/doc.png" style="padding: 0" />
                        <p:fileDownload value="#{informeBean.file}" />
                    </h:commandLink>
                    <h:commandLink actionListener="#{informeBean.exportarInforme('PDF', 'conclusiones')}" title="Conclusiones">
                        <p:graphicImage value="/images/pdf.png" style="padding: 0" />
                        <p:fileDownload value="#{informeBean.file}" />
                    </h:commandLink></td>
                </tr>
                </table>
            </p:outputPanel>
            <br/>
            
            <h1 class="nombreInforme">Informe de la Inspecci√≥n #{informeBean.informe.inspeccion.tipoInspeccion.descripcion} realizada a #{informeBean.informe.inspeccion.tipoUnidad.descripcion} de #{informeBean.informe.inspeccion.ambito.descripcion} de #{informeBean.informe.inspeccion.municipio.provincia.nombre}</h1>
                        
            <div class="ql-editor" id="informe" >
                <ol class="titulos">
	                <ui:repeat value="#{informeBean.listaAreas}" var="area">
		                <li>
		                   <h2 class="enumerado"><h:outputText value="#{area.descripcion}"/></h2>
		                    <ol class="titulos">
			                    <ui:repeat value="#{informeBean.mapaAreasSubareas[area]}" var="subarea">
			                        <li>
                                        <h3 class="enumerado"><h:outputText value="#{subarea.descripcion}"/></h3>
    			                        <h:outputText value="#{informeBean.mapaRespuestas[subarea][0]}" escape="false"/>
                                        <h:outputFormat rendered="#{not empty informeBean.mapaRespuestas[subarea][1]}">
                                            <li><h4><h:outputText value="Conclusiones y propuestas."/></h4></li>
                                            <h:outputText value="#{informeBean.mapaRespuestas[subarea][1]}" escape="false"/>
                                        </h:outputFormat>
                                    </li>
			                    </ui:repeat>
		                    </ol>
	                    </li>
	                </ui:repeat>
                </ol>
            </div>

            <div class="botonesFormulario">
                <p:button value="Volver" icon="fa fa-fw fa-undo" outcome="/informes/informes" />
            </div>
        </h:form>

    </ui:define>
</ui:composition>