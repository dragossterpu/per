<ui:composition template="../layouts/layoutInterior.xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:p="http://primefaces.org/ui">
    <ui:define name="content">

        <h:form id="informe">
            <ui:param name="yaFinalizado" value="#{not empty informeBean.informe.fechaFinalizacion}" />
                    
            <ui:param name="titulo" value="Informe" />
            <f:event listener="#{navegacionBean.adelante(titulo, request.servletPath)}" type="preRenderView"/>
            <h3>#{titulo}</h3>
            
            <link rel="stylesheet" href="#{request.contextPath}/css/texteditor_pdf.css" />
            <h:commandLink style="float: right;" actionListener="#{informeBean.exportarInforme('DOCX')}" rendered="#{yaFinalizado}">
                <p:graphicImage value="/images/doc.png" style="padding: 0" />
                <p:fileDownload value="#{informeBean.file}" />
            </h:commandLink>
            <h:commandLink style="float: right;" actionListener="#{informeBean.exportarInforme('PDF')}" rendered="#{yaFinalizado}">
                <p:graphicImage value="/images/pdf.png" style="padding: 0" />
                <p:fileDownload value="#{informeBean.file}" />
            </h:commandLink>
            
            <div class="ql-snow ql-editor" id="informe" >
                <ol class="titulos">
	                <ui:repeat value="#{informeBean.listaAreas}" var="area">
		                <li>
		                   <h4><h:outputText value="#{area.descripcion}"/></h4>
		                    <ol class="titulos">
			                    <ui:repeat value="#{informeBean.mapaAreasSubareas[area]}" var="subarea">
			                        <li>
                                        <h4><h:outputText value="#{subarea.descripcion}"/></h4>
    			                        <h:outputText value="#{informeBean.mapaRespuestas[subarea][0]}" escape="false"/>
                                        <h:outputFormat rendered="#{not empty informeBean.mapaRespuestas[subarea][1]}">
                                            <li><h5><h:outputText value="Conclusiones y propuestas."/></h5></li>
                                            <h:outputText value="#{informeBean.mapaRespuestas[subarea][1]}" escape="false"/>
                                        </h:outputFormat>
                                    </li>
			                    </ui:repeat>
		                    </ol>
	                    </li>
	                </ui:repeat>
                </ol>
            </div>

            <div class="botonesFormulario">
                <p:button value="Volver" icon="fa fa-fw fa-undo" outcome="/informes/informes" />
            </div>
        </h:form>

    </ui:define>
</ui:composition>