<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<f:view>
	<ui:composition template="../layouts/layoutInterior.xhtml">
		<ui:define name="content">

		<h3>Modificar Usuario</h3>
		<div class="aclaraciones">
			Los campos marcados con (*) son obligatorios
		</div>
		
		<h:form id="formAlta">
			<div class="bloqueFormulario">
					<h4>Datos Personales</h4>
					<div class="columnaIzdaFormulario">
						<h:outputLabel for="nombre" value="Nombre (*):" />
						<p:inputText id="nombre" value="#{userBean.user.nombre}" required="true" requiredMessage="Introduzca el nombre" converter="#{trimConverter}"/>
						<p:messages for="nombre" autoUpdate="true"  closable="true"/>
	
						<h:outputLabel for="apellido1" value="Primer apellido (*):" converter="#{trimConverter}"/>
						<p:inputText id="apellido1" value="#{userBean.user.apellido1}" required="true" requiredMessage="Introduzca el primer apellido"/>
						<p:messages for="apellido1" autoUpdate="true"  closable="true"/>
						
						<h:outputLabel for="numIdentificacion" value="Número de identificación:" />
						<p:inputText id="numIdentificacion" value="#{userBean.user.numIdentificacion}" maxlength="15" converter="#{trimConverter}"/>
	
						<h:outputLabel for="correo" value="Correo electrónico (*): " />
						<p:inputText id="correo" value="#{userBean.user.correo}"  required="true" 
							requiredMessage="Introduzca el correo electrónico"
							validatorMessage="Formato de correo incorrecto" converter="#{trimConverter}">
							<f:validateRegex pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
						</p:inputText>
						<p:messages for="correo" autoUpdate="true"  closable="true"/>
						
						<h:outputLabel for="fechaDestino" value="Fecha destino IPSS (*):" />
						<p:calendar value="#{userBean.user.fechaDestinoIPSS}" id="fechaDestino" pattern="dd/MM/yyyy" navigator="true"
								required="true" requiredMessage="Introduzca la fecha de destino a la IPSS"/>
						<p:messages for="fechaDestino" autoUpdate="true"  closable="true"/>
					</div>
	
					<div class="columnaDchaFormulario">
						<h:outputLabel for="fechaAlta" value="Fecha alta:" />
						<p:inputText id="fechaAlta" value="#{userBean.user.fechaAlta}" readonly="true">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</p:inputText>
	
						<h:outputLabel for="apellido2" value="Segundo apellido:" />
						<p:inputText id="apellido2" value="#{userBean.user.apellido2}"  converter="#{trimConverter}"/>
	
						<h:outputLabel for="telefono" value="Teléfono:" />
						<p:inputNumber id="telefono" value="#{userBean.user.telefono}"  maxValue="999999999" />
	
						<h:outputLabel for="docIndentidad" value="NIF: " />
						<p:inputText id="docIndentidad" value="#{userBean.user.docIndentidad}" converter="#{trimConverter}"/>
					</div>
			</div>
	
			<div class="bloqueFormulario">
				<h4>Perfil</h4>
	
				<div class="columnaIzdaFormulario">
					<h:outputLabel for="username" value="Nombre usuario (*):" />
					<p:inputText id="username" value="#{userBean.user.username}" readonly="true"/>
						
					<h:outputLabel for="estado" value="Estado:" />
					<p:importEnum type="es.mira.progesin.persistence.entities.enums.EstadoEnum" var="estados"
						allSuffix="ALL_ENUM_VALUES" />
					<p:selectOneMenu value="#{userBean.user.estado}" id="estado"
							required="true" requiredMessage="Seleccione un estado para el usuario">
						<f:selectItems value="#{estados.ALL_ENUM_VALUES}" var="estadoUser"
							itemLabel="#{estadoUser}" itemValue="#{estadoUser}" />
					</p:selectOneMenu>
					 <p:messages for="estado" autoUpdate="true"  closable="true"/> 
					
					<h:outputLabel for="puestoTrabajoSelect" value="Puesto de trabajo (*):" />
					<p:selectOneMenu value="#{userBean.user.puestoTrabajo}" id="puestoTrabajoSelect" 
							required="true" requiredMessage="Seleccione un puesto de trabajo"
							converter="#{selectConverter}">
						<f:selectItems value="#{userBean.puestosTrabajo}" var="puestoTrabajo"
							itemLabel="#{puestoTrabajo.descripcion}" itemValue="#{puestoTrabajo}" />
					</p:selectOneMenu>
					<p:messages for="puestoTrabajoSelect" autoUpdate="true"  closable="true"/>
					
					<h:outputLabel for="envioNotificacion" value="¿Envío notificaciones? (*)" />
 					<p:selectOneRadio id="envioNotificacion" value="#{userBean.user.envioNotificacion}"
 						required="true" requiredMessage="Seleccione el envío de notificaciones">
			            <f:selectItem itemLabel="SI" itemValue="SI" />
			            <f:selectItem itemLabel="NO" itemValue="NO" />
			        </p:selectOneRadio>
			        <p:messages for="envioNotificacion" autoUpdate="true"  closable="true"/>
				</div>
				
				<div class="columnaDchaFormulario">
				   <h:outputLabel for="role" value="Rol: (*)" />
			        <p:importEnum type="es.mira.progesin.persistence.entities.enums.RoleEnum" var="roles"
						allSuffix="ALL_ENUM_VALUES" />
					<p:selectOneMenu value="#{userBean.user.role}" id="role"
							required="true" requiredMessage="Seleccione un role para el usuario" panelStyleClass="hideDisabled">
						<f:selectItem itemLabel="Seleccione uno" itemValue=""/>
						<f:selectItems value="#{roles.ALL_ENUM_VALUES}" var="roleUser"
							itemLabel="#{roleUser.descripcion}" itemValue="#{roleUser}" itemDisabled="#{roleUser.prov}"/>
					</p:selectOneMenu>
					 <p:messages for="role" autoUpdate="true"  closable="true"/>
					
					<h:outputLabel for="cuerpoEstadoSelect" value="Cuerpo del estado (*):" />
					<p:selectOneMenu value="#{userBean.user.cuerpoEstado}" id="cuerpoEstadoSelect"
							required="true" requiredMessage="Seleccione un cuerpo del estado"
							converter="#{selectConverter}">
						<f:selectItems value="#{userBean.cuerposEstado}" var="cuerpoEstado"
							itemLabel="#{cuerpoEstado.descripcion}" itemValue="#{cuerpoEstado}" />
					</p:selectOneMenu>
					<p:messages for="cuerpoEstadoSelect" autoUpdate="true"  closable="true"/>
					
					<h:outputLabel for="nivel" value="Nivel (*):" />
					<p:inputNumber id="nivel" value="#{userBean.user.nivel}"  required="true" requiredMessage="Introduzca el nivel del usuario" maxValue="99" converter="#{trimConverter}"/>
					<p:messages for="nivel" autoUpdate="true"  closable="true"/>
				</div>
			</div>
			
			<div class="botonesFormulario">
				<p:commandButton actionListener="#{userBean.modificarUsuario}" value="Guardar cambios" icon="fa fa-fw fa-save"/>
				<p:button outcome="/users/usuarios" value="Cancelar" icon="fa fa-fw fa-undo"/>
				<p:commandButton actionListener="#{userBean.restaurarClave}" value="Restaurar clave" />
			</div>
			
			<p:dialog id="dialog" widgetVar="dialogMessage" header="INFO">
				<p:ajax event="close" listener="#{facesUtilities.redirect('/users/usuarios')}" />
				<p:messages for="dialogMessage" autoUpdate="true" showDetail="true" showSummary="true"/>
				<div class="centrarBotonesDialog">
					<p:commandButton value="Cerrar" actionListener="#{facesUtilities.redirect('/users/usuarios')}" />
				</div>
			</p:dialog>
			
		</h:form>
		
		</ui:define>
	</ui:composition>
</f:view>
</html>
